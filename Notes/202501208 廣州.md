---
cssclasses:
  - editor-full
---

```dataviewjs
const css = `
.dataview-table-container table {
    width: 100%;
    border-collapse: collapse;
    margin: 25px auto;
    font-size: 0.9em;
    box-shadow: 0 0 10px rgba(0,0,0,0.05);
    border-radius: 8px;
    overflow: hidden;
    text-align: center;
    table-layout: auto;
    border: 1px solid var(--background-modifier-border);
}

.dataview-table-container th,
.dataview-table-container td {
    padding: 12px 15px;
    text-align: center;
    vertical-align: middle;
    border: 1px solid var(--background-modifier-border);
}

.dataview-table-container thead tr {
    background-color: var(--color-blue);
    color: white;
    font-weight: bold;
}

.dataview-table-container tbody tr:nth-child(even) {
    background-color: var(--background-primary-alt);
}

.dataview-table-container tbody tr:hover {
    background-color: var(--background-secondary);
}
`;

function basicMarkdownInline(text) {
    if (!text) return '';
    return text
        .replace(/(\*\*|__)(.*?)\1/g, '<strong>$2</strong>') // bold
        .replace(/(\*|_)(.*?)\1/g, '<em>$2</em>');            // italic
}

const style = document.createElement('style');
style.textContent = css;
document.head.appendChild(style);

const content = await dv.io.load(dv.current().file.path);

// Split content into sections using "END" as a delimiter
const sections = content.split(/\n\s*END\s*\n/).map(section => section.trim()).filter(section => section);
let counter = 0;

for (const section of sections) {
    // Find table in the section
    const tableRegex = /(?:^|\n)(?!```)(\|.*\|[\s\S]*?)(?=\n[^|`]|$)/;
    const tableMatch = section.match(tableRegex);
    if (!tableMatch) continue;

    const tableMarkdown = tableMatch[0].trim();
    if (!tableMarkdown) continue;

    const precedingText = section.substring(0, tableMatch.index);
    const codeBlockCount = (precedingText.match(/```/g) || []).length;
    if (codeBlockCount % 2 !== 0) continue;

    // Extract title: Look for the closest heading before the table
    const titleMatch = precedingText.match(/^#+.*$/gm);
    let title = `Table ${++counter}`; // Default title
    if (titleMatch) {
        const headings = titleMatch.map(heading => ({
            text: heading.replace(/^#+\s*/, ''),
            index: section.lastIndexOf(heading, tableMatch.index)
        }));
        headings.sort((a, b) => b.index - a.index);
        if (headings.length > 0) {
            title = headings[0].text;
        }
    }

    // 1. Title
    dv.el('h3', title);

    // 2. Table
    const tableContainer = dv.el('div', '', { cls: 'dataview-table-container' });
    const table = document.createElement('table');
    const lines = tableMarkdown.trim().split('\n');

    // Process header row, preserving all cells including empty ones
    const headerRow = lines[0].split('|').slice(1, -1).map(cell => cell.trim() || '');
    const bodyRows = lines.slice(2).map(row => row.split('|').slice(1, -1).map(cell => cell.trim() || ''));

    const thead = document.createElement('thead');
    const trHead = document.createElement('tr');
    headerRow.forEach(cell => {
        const th = document.createElement('th');
        th.innerHTML = basicMarkdownInline(cell || '-');
        if (!cell) {
            th.style.color = 'var(--text-faint)';
            th.style.fontStyle = 'italic';
        }
        trHead.appendChild(th);
    });
    thead.appendChild(trHead);
    table.appendChild(thead);

    const tbody = document.createElement('tbody');
    bodyRows.forEach(row => {
        const tr = document.createElement('tr');
        for (let i = 0; i < headerRow.length; i++) {
            const cell = row[i] || '';
            const td = document.createElement('td');
            td.innerHTML = basicMarkdownInline(cell || '-');
            if (!cell) {
                td.style.color = 'var(--text-faint)';
                td.style.fontStyle = 'italic';
            }
            tr.appendChild(td);
        }
        tbody.appendChild(tr);
    });

    table.appendChild(tbody);
    tableContainer.appendChild(table);

    // 3. Remarks/Others for this table
    const remarksContent = section.substring(tableMatch.index + tableMatch[0].length).trim();
    if (remarksContent) {
        dv.el('div', remarksContent);
    }
}
```





---


### Original

| No. | æ—¶é—´    | åœ°ç‚¹   | è¡Œç¨‹  | å¤‡æ³¨  |
| --- | ----- | ---- | --- | --- |
| 1   | 11:40 | å¹¿å·žç«™  | é›†åˆ  |     |
| 2   | 12:20 | ä¿åˆ©å¹¿åœº | åƒé¥­  |     |
|     | 13:45 | æ°´åšè‹‘  | ç”µè½¦  |     |
|     |       |      |     |     |
|     |       |      |     |     |
|     |       |      |     |     |
*\*RMB*
##### Others
- ä¸‡èƒœå›´
ðŸš‡ä¸‡èƒœå›´ç«™ï¼ˆé»„åŸ”å¤æ¸¯ï¼‰
ç¾Žé£Ÿ:å¥¶å©†å§œæ’žå¥¶ã€çŒ«è®°è‰‡ä»”ç²¥ã€é˜¿å”é±¼çš®
æ™¯ç‚¹:ç²¤æµ·åšç‰©é¦†ã€é»„åŸ”æ‘åŽ†å²äººæ–‡å±•è§ˆé¦†ã€åŒ—å¸åº™

ðŸš‡ä¸‡èƒœå›´ Bå£âž¡ï¸è½¨ç”µè½¦ï¼ˆç¶é†ç«™ï¼‰
ç¶é†ä¸´æ±Ÿé£Žæ™¯å·¨ç¾Žï¼Œæ™šä¸Šçš„å¹¿å·žå°è›®è…°å·¨æ¼‚äº®


â‘ ä¸‡èƒœå›´-é»„æµ¦å¤æ¸¯
æœ‰å¤è‰²å¤é¦™çš„æ—…æ¸¸èƒœåœ°-é»„æµ¦å¤æ¸¯ï¼Œå¯ä»¥åŽ»å¯»è§…ç¾Žé£Ÿï¼Œä¹Ÿå¯ä»¥æŽ¢ç´¢å¹¿å·žå¤æ‘ï¼Œå“å°é»„æµ¦å§œæ’žå¥¶

2 ç¶æ´²å¡”ç«™-ç¶æ´²å¡”
ç¶æ´²å¡”æ›¾æ˜¯å¤ä»£æµ·ä¸Šä¸ç»¸ä¹‹è·¯çš„é‡è¦èˆªæ ‡ï¼Œå…¬å›­å†…ç»¿æ ‘æˆè«ï¼Œé€‚åˆé‡Žé¤ã€æ•£æ­¥ã€‚

3 ç¶æ´²å¤§æ¡¥å—-æ°´åšè‹‘
å¹¿å·žäººå‘¨æœ«çš„éœ²è¥èƒœåœ°ï¼Œä¹Ÿæ˜¯å¹¿å·žä¸ç»¸ä¹‹è·¯ä¸Šçš„é‡è¦é—å€ï¼Œå…¬å›­ä¸å¤§ä½†å¾ˆchillï¼Œæ¸¸å®¢ä¸­å¿ƒæ–°å¼€äº†å’–å•¡åŽ…ï¼Œå¯ä»¥ååœ¨çª—è¾¹äº«å—ä¸€æ•´ç‰‡å›­æ™¯ã€‚

4 ä¼šå±•ä¸œç«™-èµèŠ±
11æœˆè½¨é“æ—çš„å¼‚æœ¨æ£‰å¼€å¾—æ­£ç››ï¼Œé˜³å…‰é€è¿‡äº”å½©çŽ»ç’ƒç…§å°„åˆ°åœ°é¢ï¼Œå¾ˆç¾Žå¾ˆç¾Žã€‚è¿˜å¯ä»¥æ¼«æ­¥æ±Ÿè¾¹è‰åªã€‚

5 ç¶é†ç«™-æ–‡åŒ–åˆ›æ„åŒº
å·¥ä¸šé£Žè‰ºæœ¯å›­åŒº+æ±Ÿæ™¯é…’å§ï¼Œä¸€å®šè¦é€‰åœ¨è¿™åƒæ™šé¤ï¼Œå¤œæ™šå¯ä»¥æ‹çŒŽå¾·å¤§æ¡¥ä¸Žå¹¿å·žå¡”åŒæ¡†ï¼Œè¶…å‡ºç‰‡ï¼

6çŒ«å¾·å¤§ã®‡å—ç«™-ç æ±Ÿå¤œæ™¯
å¹¿å·žzuiæœ‰ç‰¹è‰²è·¨æµ·å¤§æ¡¥ï¼Œç™»æ¡¥ä¿¯çž°ç æ±Ÿæ–°åŸŽå¤œæ™¯ï¼Œæ™šé£Žä¸Žéœ“è™¹äº¤ç»‡ï¼Œæ°›å›´æ„Ÿæ‹‰æ»¡ã€‚å¯ä»¥æ‹é»„æ˜æ—¥è½+å¹¿å·žå¡”çŒ«å¾·å¤§ã®‡+ç æ±Ÿæ±Ÿæ™¯+å¤©æ²³cbd=å¹¿å·žé†‰

---

END


### HKD
| äºº          | RMB     | (+/- RMB) | HKD [(RMB Â± adj)/0.92] | +/- (HKD) | Final (HKD) |
| ---------- | ------- | --------- | ---------------------- | --------- | ----------- |
| Ivan L     | 1039.80 |           | 1130.22                |           | 1130.22     |
| Arthur L   | 941.80  |           | 1023.70                |           | 1023.70     |
| Rachel L   | 838.75  |           | 911.68                 |           | 911.68      |
| Thomas L   | 366.55  | +84       | 489.73                 |           | 489.73      |
| Rex C      | 900.05  |           | 978.32                 |           | 978.32      |
| Jennifer C | 998.50  |           | 1085.33                | -155.36   | 929.97      |
| Justin S   | 900.05  | +70       | 1054.40                |           | 1054.40     |
| Air T      | 1043.50 |           | 1134.24                |           | 1134.24     |

*\*HKD* åŒ¯çŽ‡0.92

---

END

### Final

| äºº          | Final (HKD) |
| ---------- | ----------- |
| Ivan L     | 1130.22     |
| Arthur L   | 1023.70     |
| Rachel L   | 911.68      |
| Thomas L   | 489.73      |
| Rex C      | 978.32      |
| Jennifer C | 929.97      |
| Justin S   | 1054.40     |
| Air T      | 1134.24     |

- [x] Ivan L	1130.22
- [x] Arthur L	1023.70
- [x] Rachel L	911.68
- [x] Thomas L	489.73
- [ ] Rex C	978.32
- [x] Jennifer C	929.97
- [x] Justin S	1054.40
- [x] Air T	1134.24
